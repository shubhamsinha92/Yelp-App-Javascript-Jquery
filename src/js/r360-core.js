/*
 Route360° JavaScript API v0.2.1 ("902dc64"), a JS library for leaflet maps. http://route360.net
 (c) 2014 Henning Hollburg and Daniel Gerber, (c) 2014 Motion Intelligence GmbH
*/
!function(e,t,n){function o(){var t=e.r360;r.noConflict=function(){return e.r360=t,this},e.r360=r}var r={version:"v0.2.1",isUndefined:function(e){return void 0===e},has:function(e,t){return null!=e&&hasOwnProperty.call(e,t)},isFunction:function(e){return"function"==typeof e||!1},findWhere:function(e,t){var i=n;return e.some(function(e,n,o){var a=!1;for(var n in t)a=r.has(e,n)&&e[n]===t[n]?!0:!1;return a?(i=e,!0):void 0}),i},filter:function(e,t){var n=[];return e.forEach(function(e,i,o){t(e,i,o)&&n.push(e)}),n},contains:function(e,t){return e.indexOf(t)>-1},each:function(e,t){e.forEach(function(e,n,i){t(e,n,i)})},max:function(e,t,n){var i,o,a=-(1/0),s=-(1/0);if(null==t||"number"==typeof t&&"arrayect"!=typeof e[0]&&null!=e)for(var l=0,h=e.length;h>l;l++)i=e[l],null!=i&&i>a&&(a=i);else r.each(e,function(e,n,i){o=t(e,n,i),(o>s||o===-(1/0)&&a===-(1/0))&&(a=e,s=o)});return a},keys:function(e){if("Object"!=typeof e)return[];if(Object.keys(e))return Object.keys(e);var t=[];for(var n in e)r.has(e,n)&&t.push(n);return t}};"object"==typeof module&&"object"==typeof module.exports?module.exports=r:"function"==typeof define&&define.amd?define(r):o(),Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,i=function(){},o=function(){return n.apply(this instanceof i&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype,o.prototype=new i,o}),r.config={serviceUrl:"https://service.route360.net/brandenburg/",nominatimUrl:"https://geocode.route360.net/",osmServiceUrl:"https://api.route360.net/r360-osm-api-norway/",serviceVersion:"v1",pathSerializer:"compact",requestTimeout:1e4,maxRoutingTime:3600,bikeSpeed:15,bikeUphill:20,bikeDownhill:-10,walkSpeed:5,walkUphill:10,walkDownhill:0,travelTimes:[300,600,900,1200,1500,1800],travelType:"walk",logging:!1,defaultTravelTimeControlOptions:{travelTimes:[{time:300,color:"#006837",opacity:.1},{time:600,color:"#39B54A",opacity:.2},{time:900,color:"#8CC63F",opacity:.3},{time:1200,color:"#F7931E",opacity:.4},{time:1500,color:"#F15A24",opacity:.5},{time:1800,color:"#C1272D",opacity:1}],position:"topright",label:"travel time",initValue:30},routeTypes:[{routeType:"WALK",color:"red",haloColor:"white"},{routeType:"BIKE",color:"#558D54",haloColor:"white"},{routeType:"CAR",color:"#558D54",haloColor:"white"},{routeType:"TRANSFER",color:"#C1272D",haloColor:"white"},{routeType:102,color:"#006837",haloColor:"white"},{routeType:400,color:"#156ab8",haloColor:"white"},{routeType:900,color:"red",haloColor:"white"},{routeType:700,color:"#A3007C",haloColor:"white"},{routeType:1e3,color:"blue",haloColor:"white"},{routeType:109,color:"#006F35",haloColor:"white"},{routeType:100,color:"red",haloColor:"white"},{routeType:1,color:"red",haloColor:"red"},{routeType:2,color:"blue",haloColor:"blue"},{routeType:3,color:"yellow",haloColor:"yellow"},{routeType:0,color:"green",haloColor:"green"},{routeType:4,color:"orange",haloColor:"orange"},{routeType:5,color:"red",haloColor:"red"},{routeType:6,color:"blue",haloColor:"blue"},{routeType:7,color:"yellow",haloColor:"yellow"}],defaultPlaceAutoCompleteOptions:{serviceUrl:"https://geocode.route360.net/solr/select?",position:"topleft",reset:!1,reverse:!1,autoHide:!0,placeholder:"Select source",maxRows:5,width:300},photonPlaceAutoCompleteOptions:{serviceUrl:"https://geocode2.route360.net/photon/api?",position:"topleft",reset:!1,reverse:!1,placeholder:"Select source",maxRows:5,width:300},defaultRadioOptions:{position:"topright"},defaultPolygonLayerOptions:{opacity:.4,strokeWidth:30,tolerance:15,backgroundColor:"black",backgroundOpacity:.5,inverse:!1,animate:!1,animationDuration:1},i18n:{language:"en",configuredLanguages:["en","de","no"],info:{en:"More information",de:"Mehr informationen",no:"Mer Informasjon"},fullscreen:{en:"Fullscreen",de:"Vollbild",no:"Fullskjerm"},slow:{en:"Slow",de:"Langsam",no:"Sakte"},low:{en:"Low",de:"Gering",no:"Lav"},medium:{en:"Medium",de:"Mittel",no:"Medium"},fast:{en:"Fast",de:"Schnell",no:"Raskt"},high:{en:"High",de:"Hoch",no:"Høy"},departure:{en:"Departure",de:"Abfahrt",no:"TODO TRANSLATION: "},placeholderSrc:{en:"Select source!",de:"Start wählen!",no:"Start"},placeholderTrg:{en:"Select target!",de:"Ziel wählen!",no:"Mål"},line:{en:"Line",de:"Linie",no:"TODO TRANSLATION: "},arrival:{en:"Arrival",de:"Ankunft",no:"TODO TRANSLATION: "},from:{en:"From",de:"Von",no:"TODO TRANSLATION: "},to:{en:"To",de:"Nach",no:"TODO TRANSLATION: "},travelTime:{en:"Travel time",de:"Reisezeit",no:"Reisetid"},totalTime:{en:"Total time",de:"Gesamtzeit",no:"TODO TRANSLATION: "},batteryCapacity:{en:"Battery capacity",de:"Akkuleistung",no:"Batterikapasitet"},distance:{en:"Distance",de:"Distanz",no:"Avstand"},wait:{en:"Please wait!",de:"Bitte warten!",no:"Vennligst vent!"},polygonWait:{en:"Calculating reachable area!",de:"Berechne erreichbare Fläche!",no:"Vennligst vent!"},routeWait:{en:"Searching route to target(s)!",de:"Suche Route zum Ziel!",no:"Vennligst vent!"},timeWait:{en:"Getting travel times to target(s)!",de:"Berechne Reisezeiten für Ziele!",no:"Vennligst vent!"},osmWait:{en:"Searching for points of interests!",de:"Suche nach Sehenswürdigkeiten!",no:"Vennligst vent!"},populationWait:{en:"Calculating population statistics!",de:"Berechne Bevölkerungsstatistik!",no:"Vennligst vent!"},elevation:{en:"Elevation",de:"Höhenunterschied",no:"Stigning"},timeFormat:{en:"a.m.",de:"Uhr",no:"TODO_TRANSLATION"},reset:{en:"Reset input",de:"Eingeben löschen",no:"Reset"},reverse:{en:"Switch source and target",de:"Start und Ziel tauschen",no:"Motsatt"},settings:{en:"Switch travel type",de:"Reisemodus wechseln",no:"Reisemåte"},noRouteFound:{en:"No route found!",de:"Keine Route gefunden!",no:"TODO TRANSLATION"},monthNames:{en:["January","February","March","April","May","June","July","August","September","October","November","December"],de:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],no:["TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION"]},dayNames:{en:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],de:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],no:["TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION"]},dayNamesMin:{en:["Su","Mo","Tu","We","Th","Fr","Sa"],de:["So","Mo","Di","Mi","Do","Fr","Sa"],no:["TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION","TODO_TRANSLATION"]},museum:{en:"Museum",de:"Museum",no:"Museum"},swimming_pool:{en:"Swimming pool",de:"Schwimmbad",no:"Svømmebassenger"},restaurant:{en:"Restaurant",de:"Restaurant",no:"Restaurant"},cinema:{en:"Cinema",de:"Kino",no:"Kino"},theater:{en:"Theater",de:"Theater",no:"Teater"},library:{en:"Library",de:"Bibliothek",no:"Bibliotek"},bike_rental_station:{en:"Bike rental station",de:"Fahrradleihstation",no:"TODO TRANSLATION"},cycling_speed_help:{en:"Cycling speed: {}km/h",de:"Fahrradgeschwindigkeit: {}km/h",no:"G Fart: {}km/h, Fart: {}km/h"},walking_speed_help:{en:"Walk speed: {}km/h",de:"Laufgeschwindigkeit: {}km/h",no:"Fart: {}km/h"},walking_and_cycling_speed_help:{en:"Walk speed: {}km/h, Cycling speed: {}km/h",de:"Laufgeschwindigkeit: {}km/h, Fahrradgeschwindigkeit: {}km/h",no:"Fart: {}km/h (Gå), Fart: {}km/h (Sykle)"},ebike_speed_help_fast:{en:"Little support from the pedelec",de:"Keine Unterstützung durch das Pedelec",no:"Høy egeninnsats - Lav motorinnsats"},ebike_speed_help_medium:{en:"Medium support from the pedelec",de:"Mittlere Unterstützung durch das Pedelec",no:"Medium egeninnsats - Medium motorinnsats"},ebike_speed_help_slow:{en:"Full support from the pedelec",de:"Volle Unterstützung durch das Pedelec",no:"Lav egeninnsats - Høy motorinnsats"},contribution:{en:"Personal contribution",de:"Eigenleistung",no:"Egeninnsats"},low_contribution:{en:"Low personal contribution",de:"Geringe Eigenleistung",no:"Lav Egeninnsats"},switchLanguage:function(){var e=[];_.each(r.config.i18n.configuredLanguages,function(t){e.push("[lang='"+t+"']")}),$(e.join(", ")).hide(),$("[lang='"+r.config.i18n.language+"']").show()},getSpan:function(e){var t="";return _.each(_.keys(r.config.i18n[e]),function(n){t+='<span lang="'+n+'">'+r.config.i18n[e][n]+"</span>"}),t},getSpan:function(e,t){var n="";return _.each(_.keys(r.config.i18n[e]),function(i){var o=r.config.i18n[e][i];_.each(t,function(e){o=o.replace("{}",e)}),n+='<span lang="'+i+'">'+o+"</span>"}),""==n?"_"+e+"_":n},get:function(e){var t;return _.each(_.keys(r.config.i18n),function(n){e==n&&(t=r.config.i18n[e][r.config.i18n.language])}),t}}},r.Bounds=function(e,t){if(e)for(var n=t?[e,t]:e,i=0,o=n.length;o>i;i++)this.extend(n[i])},r.Bounds.prototype={extend:function(e){return e=r.point(e),this.min||this.max?(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(e.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(e.y,this.max.y)):(this.min=e.clone(),this.max=e.clone()),this},getCenter:function(e){return new r.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return new r.Point(this.min.x,this.max.y)},getTopRight:function(){return new r.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(e){var t,n;return e="number"==typeof e[0]||e instanceof r.Point?r.point(e):r.bounds(e),e instanceof r.Bounds?(t=e.min,n=e.max):t=n=e,t.x>=this.min.x&&n.x<=this.max.x&&t.y>=this.min.y&&n.y<=this.max.y},intersects:function(e){e=r.bounds(e);var t=this.min,n=this.max,i=e.min,o=e.max,a=o.x>=t.x&&i.x<=n.x,s=o.y>=t.y&&i.y<=n.y;return a&&s},overlaps:function(e){e=r.bounds(e);var t=this.min,n=this.max,i=e.min,o=e.max,a=o.x>t.x&&i.x<n.x,s=o.y>t.y&&i.y<n.y;return a&&s},isValid:function(){return!(!this.min||!this.max)}},r.bounds=function(e,t){return!e||e instanceof r.Bounds?e:new r.Bounds(e,t)},r.LatLngBounds=function(e,t){if(e)for(var n=t?[e,t]:e,i=0,o=n.length;o>i;i++)this.extend(n[i])},r.LatLngBounds.prototype={extend:function(e){var t,n,i=this._southWest,o=this._northEast;if(e instanceof r.LatLng)t=e,n=e;else{if(!(e instanceof r.LatLngBounds))return e?this.extend(r.latLng(e)||r.latLngBounds(e)):this;if(t=e._southWest,n=e._northEast,!t||!n)return this}return i||o?(i.lat=Math.min(t.lat,i.lat),i.lng=Math.min(t.lng,i.lng),o.lat=Math.max(n.lat,o.lat),o.lng=Math.max(n.lng,o.lng)):(this._southWest=new r.LatLng(t.lat,t.lng),this._northEast=new r.LatLng(n.lat,n.lng)),this},pad:function(e){var t=this._southWest,n=this._northEast,i=Math.abs(t.lat-n.lat)*e,o=Math.abs(t.lng-n.lng)*e;return new r.LatLngBounds(new r.LatLng(t.lat-i,t.lng-o),new r.LatLng(n.lat+i,n.lng+o))},getCenter:function(){return new r.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new r.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new r.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(e){e="number"==typeof e[0]||e instanceof r.LatLng?r.latLng(e):r.latLngBounds(e);var t,n,i=this._southWest,o=this._northEast;return e instanceof r.LatLngBounds?(t=e.getSouthWest(),n=e.getNorthEast()):t=n=e,t.lat>=i.lat&&n.lat<=o.lat&&t.lng>=i.lng&&n.lng<=o.lng},intersects:function(e){e=r.latLngBounds(e);var t=this._southWest,n=this._northEast,i=e.getSouthWest(),o=e.getNorthEast(),a=o.lat>=t.lat&&i.lat<=n.lat,s=o.lng>=t.lng&&i.lng<=n.lng;return a&&s},overlaps:function(e){e=r.latLngBounds(e);var t=this._southWest,n=this._northEast,i=e.getSouthWest(),o=e.getNorthEast(),a=o.lat>t.lat&&i.lat<n.lat,s=o.lng>t.lng&&i.lng<n.lng;return a&&s},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(e){return e?(e=r.latLngBounds(e),this._southWest.equals(e.getSouthWest())&&this._northEast.equals(e.getNorthEast())):!1},isValid:function(){return!(!this._southWest||!this._northEast)}},r.latLngBounds=function(e,t){return!e||e instanceof r.LatLngBounds?e:new r.LatLngBounds(e,t)},r.Point=function(e,t,n){this.x=n?Math.round(e):e,this.y=n?Math.round(t):t},r.Point.prototype={clone:function(){return new r.Point(this.x,this.y)},add:function(e){return this.clone()._add(r.point(e))},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(r.point(e))},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e){return this.clone()._divideBy(e)},_divideBy:function(e){return this.x/=e,this.y/=e,this},multiplyBy:function(e){return this.clone()._multiplyBy(e)},_multiplyBy:function(e){return this.x*=e,this.y*=e,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},distanceTo:function(e){e=r.point(e);var t=e.x-this.x,n=e.y-this.y;return Math.sqrt(t*t+n*n)},equals:function(e){return e=r.point(e),e.x===this.x&&e.y===this.y},contains:function(e){return e=r.point(e),Math.abs(e.x)<=Math.abs(this.x)&&Math.abs(e.y)<=Math.abs(this.y)},toString:function(){return"Point("+r.Util.formatNum(this.x)+", "+r.Util.formatNum(this.y)+")"}},r.point=function(e,t,i){return e instanceof r.Point?e:r.Util.isArray(e)?new r.Point(e[0],e[1]):e===n||null===e?e:new r.Point(e,t,i)},r.LatLng=function(e,t,i){if(isNaN(e)||isNaN(t))throw new Error("Invalid LatLng object: ("+e+", "+t+")");this.lat=+e,this.lng=+t,i!==n&&(this.alt=+i)},r.LatLng.prototype={equals:function(e,t){if(!e)return!1;e=r.latLng(e);var i=Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng));return(t===n?1e-9:t)>=i},toString:function(e){return"LatLng("+r.Util.formatNum(this.lat,e)+", "+r.Util.formatNum(this.lng,e)+")"},distanceTo:function(e){return r.CRS.Earth.distance(this,r.latLng(e))},wrap:function(){return r.CRS.Earth.wrapLatLng(this)},toBounds:function(e){var t=180*e/40075017,n=t/Math.cos(Math.PI/180*this.lat);return r.latLngBounds([this.lat-t,this.lng-n],[this.lat+t,this.lng+n])},clone:function(){return new r.LatLng(this.lat,this.lng,this.alt)}},r.latLng=function(e,t,i){return e instanceof r.LatLng?e:r.Util.isArray(e)&&"object"!=typeof e[0]?3===e.length?new r.LatLng(e[0],e[1],e[2]):2===e.length?new r.LatLng(e[0],e[1]):null:e===n||null===e?e:"object"==typeof e&&"lat"in e?new r.LatLng(e.lat,"lng"in e?e.lng:e.lon,e.alt):t===n?null:new r.LatLng(e,t,i)},function(){var n=navigator.userAgent.toLowerCase(),i=t.documentElement,o="ActiveXObject"in e,a=-1!==n.indexOf("webkit"),s=-1!==n.indexOf("phantom"),l=-1!==n.search("android [23]"),h=-1!==n.indexOf("chrome"),u=-1!==n.indexOf("gecko")&&!a&&!e.opera&&!o,g="undefined"!=typeof orientation||-1!==n.indexOf("mobile"),d=navigator.msPointerEnabled&&navigator.msMaxTouchPoints&&!e.PointerEvent,c=e.PointerEvent&&navigator.pointerEnabled&&navigator.maxTouchPoints||d,p=o&&"transition"in i.style,f="WebKitCSSMatrix"in e&&"m11"in new e.WebKitCSSMatrix&&!l,m="MozPerspective"in i.style,y="OTransition"in i.style,k=!e.L_NO_TOUCH&&!s&&(c||"ontouchstart"in e||e.DocumentTouch&&t instanceof e.DocumentTouch);r.Browser={ie:o,ielt9:o&&!t.addEventListener,webkit:a,gecko:u,android:-1!==n.indexOf("android"),android23:l,chrome:h,safari:!h&&-1!==n.indexOf("safari"),ie3d:p,webkit3d:f,gecko3d:m,opera12:y,any3d:!e.L_DISABLE_3D&&(p||f||m)&&!y&&!s,mobile:g,mobileWebkit:g&&a,mobileWebkit3d:g&&f,mobileOpera:g&&e.opera,mobileGecko:g&&u,touch:!!k,msPointer:!!d,pointer:!!c,retina:(e.devicePixelRatio||e.screen.deviceXDPI/e.screen.logicalXDPI)>1}}(),r.Class=function(){},r.Class.extend=function(e){var t=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},n=t.__super__=this.prototype,i=r.Util.create(n);i.constructor=t,t.prototype=i;for(var o in this)this.hasOwnProperty(o)&&"prototype"!==o&&(t[o]=this[o]);return e.statics&&(r.extend(t,e.statics),delete e.statics),e.includes&&(r.Util.extend.apply(null,[i].concat(e.includes)),delete e.includes),i.options&&(e.options=r.Util.extend(r.Util.create(i.options),e.options)),r.extend(i,e),i._initHooks=[],i.callInitHooks=function(){if(!this._initHooksCalled){n.callInitHooks&&n.callInitHooks.call(this),this._initHooksCalled=!0;for(var e=0,t=i._initHooks.length;t>e;e++)i._initHooks[e].call(this)}},t},r.Class.include=function(e){r.extend(this.prototype,e)},r.Class.mergeOptions=function(e){r.extend(this.prototype.options,e)},r.Class.addInitHook=function(e){var t=Array.prototype.slice.call(arguments,1),n="function"==typeof e?e:function(){this[e].apply(this,t)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n)},r.PolygonUtil={clip:function(e,t){var n,o,r,a,s=function(e){return(o[0]-n[0])*(e[1]-n[1])>(o[1]-n[1])*(e[0]-n[0])},l=function(){var e=[n[0]-o[0],n[1]-o[1]],t=[r[0]-a[0],r[1]-a[1]],i=n[0]*o[1]-n[1]*o[0],s=r[0]*a[1]-r[1]*a[0],l=1/(e[0]*t[1]-e[1]*t[0]);return[(i*t[0]-s*e[0])*l,(i*t[1]-s*e[1])*l]},h=e,n=t[t.length-1];for(j in t){var o=t[j],u=h;h=[],r=u[u.length-1];for(i in u){var a=u[i];s(a)?(s(r)||h.push(l()),h.push(a)):s(r)&&h.push(l()),r=a}n=o}return h},isCollinear:function(e,t,n){if(e.x==n.x&&e.y==n.y)return!1;if(e.x==t.x&&t.x==n.x)return!0;if(e.y==t.y&&t.y==n.y)return!0;var i=e.x*(t.y-n.y)+t.x*(n.y-e.y)+n.x*(e.y-t.y);return i<r.config.defaultPolygonLayerOptions.tolerance&&i>-r.config.defaultPolygonLayerOptions.tolerance&&e.x!=n.x&&e.y!=n.y?!0:!1},scale:function(e,t){return r.point(e.x*t,e.y*t)},subtract:function(e,t,n){return r.point(e.x-t,e.y-n)},divide:function(e,t){return r.point(e.x/t,e.y/t)},roundPoint:function(e){return e.x=Math.round(e.x),e.y=Math.round(e.y),e},buildPath:function(e,t){return[t,Math.round(e.x),Math.round(e.y)]},getEuclidianDistance:function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},getSvgFrame:function(e,t){return[["M",0,0],["L",e,0],["L",e,t],["L",0,t],["z"]]},extendBounds:function(e,t,n){var i=Math.ceil(t),o=Math.ceil(n);return e.max.x+=i,e.min.x-=i,e.max.y+=o,e.min.y-=o,e},addPolygonToMultiPolygon:function(e,t){var n=r.filter(e,function(e){return e.getTravelTime()==t.travelTime});if(n.length>0)n[0].addPolygon(t);else{var i=new r.multiPolygon;i.setTravelTime(t.travelTime),i.addPolygon(t),i.setColor(t.getColor()),i.setOpacity(t.getOpacity()),e.push(i)}}},r.SvgUtil={getGElement:function(e,t){var n=r.Util.generateId(),i=t.opacity;return"<g id="+n+" style='opacity:"+i+"'><path style='stroke: "+t.color+"; fill: "+t.color+" ; stroke-opacity: 1; stroke-width: "+t.strokeWidth+"; fill-opacity:1'd='"+e.toString().replace(/\,/g," ")+"'/></g>"},getInverseSvgElement:function(e,t){var n=r.PolygonUtil.getSvgFrame(t.svgWidth,t.svgHeight),i="<div id=svg_"+t.id+" style='"+r.Util.getTranslation(t.offset)+";''><svg height="+t.svgHeight+" width="+t.svgWidth+" style='fill:"+t.backgroundColor+" ; opacity: "+t.backgroundOpacity+"; stroke-width: "+t.strokeWidth+"; stroke-linejoin:round; stroke-linecap:round; fill-rule: evenodd' xmlns='http://www.w3.org/2000/svg'>",o="</svg></div>",a="<defs><mask id='mask_"+t.id+"'><path style='fill-opacity:1;stroke: white; fill:white;' d='"+n.toString().replace(/\,/g," ")+"'/>"+e.join("")+"</mask></defs>",s="<path style='mask: url(#mask_"+t.id+")' d='"+n.toString().replace(/\,/g," ")+"'/>";return i+s+a+o},getNormalSvgElement:function(e,t){var n="<div id=svg_"+t.id+" style='"+r.Util.getTranslation(t.offset)+";''><svg  height="+t.svgHeight+" width="+t.svgWidth+" style='fill:"+t.backgroundColor+" ; opacity: "+t.opacity+"; stroke-linejoin:round; stroke-linecap:round; fill-rule: evenodd' xmlns='http://www.w3.org/2000/svg'>",i="</svg></div>";return n+e.join("")+i},createSvgData:function(e,t){var n=[],i=r.PolygonUtil.scale(e.getTopRightDecimal(),t.scale),o=r.PolygonUtil.scale(e.getBottomLeftDecimal(),t.scale);o.x>t.bounds.max.x||i.x<t.bounds.min.x||i.y>t.bounds.max.y||o.y<t.bounds.min.y||r.SvgUtil.buildSVGPolygon(n,e.getOuterBoundary().getCoordinates(),t);for(var a=e.getInnerBoundary(),s=0;s<a.length;s++){var l=r.PolygonUtil.scale(a[s].getTopRightDecimal(),t.scale),h=r.PolygonUtil.scale(a[s].getBottomLeftDecimal(),t.scale);h.x>t.bounds.max.x||l.x<t.bounds.min.x||l.y>t.bounds.max.y||h.y<t.bounds.min.y||r.SvgUtil.buildSVGPolygon(n,a[s].getCoordinates(),t)}return n},buildSVGPolygon:function(e,t,n){for(var i,o,a,s,l,h=0,u=[[n.bounds.min.x,n.bounds.min.y],[n.bounds.max.x,n.bounds.min.y],[n.bounds.max.x,n.bounds.max.y],[n.bounds.min.x,n.bounds.max.y]],g=[],d=0;d<t.length;d++)i=r.PolygonUtil.scale(r.point(t[d].x,t[d].y),n.scale),l=d>0?r.PolygonUtil.getEuclidianDistance(a,i):n.tolerance,l>=n.tolerance&&(s=!1,h>2&&(s=r.PolygonUtil.isCollinear(o,a,i)),s?(g[g.length-1][0]=i.x,g[g.length-1][1]=i.y):(g.push([i.x,i.y]),o=a,a=i,h++));for(var c,p=r.PolygonUtil.clip(g,u),d=0;d<p.length;d++)i=r.PolygonUtil.subtract(r.point(p[d][0],p[d][1]),n.pixelOrigin.x+n.offset.x,n.pixelOrigin.y+n.offset.y),e.push(d>0?r.PolygonUtil.buildPath(i,"L"):r.PolygonUtil.buildPath(i,"M")),c=i;return e.length>0&&e.push(["z"]),e}},r.Util={getTimeInSeconds:function(){var e=new Date;return 3600*e.getHours()+60*e.getMinutes()+e.getSeconds()},getHoursAndMinutesInSeconds:function(){var e=new Date;return 3600*e.getHours()+60*e.getMinutes()},getCurrentDate:function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,i=e.getDate()<10?"0"+e.getDate():e.getDate();return t+""+n+i},getTimeFormat:function(e){var t=r.config.i18n;return"en"==t.language&&e>=43200?"p.m.":t.get("timeFormat")},secondsToHoursAndMinutes:function(e){var t=(e/60).toFixed(0),n=Math.floor(t/60);t-=60*n;var i="";return 0!=n&&(i+=n+"h "),i+=t+"min"},secondsToTimeOfDay:function(e){var t=Math.floor(e/3600),n=Math.floor(e/60)-60*t;return e=e-3600*t-60*n,t+":"+("0"+n).slice(-2)+":"+("0"+e).slice(-2)},generateId:function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;(e?e:10)>i;i++)t+=n.charAt(Math.floor(Math.random()*n.length));return t},parseLatLonArray:function(e){for(var t=new Array,n=0;n<e.length;n++)t.push(new r.Point(e[n][0],e[n][1]));return t},getAddressByCoordinates:function(e,t,n){$.getJSON(r.config.nominatimUrl+"reverse.php?&format=json&lat="+e.lat+"&accept-language="+t+"&lon="+e.lng+"&json_callback=?",n)},getAddressByCoordinatesService:function(e,t,n){$.getJSON("https://service.route360.net/geocode/reverse?&format=json&lat="+e.lat+"&lon="+e.lng,n)},formatReverseGeocoding:function(e){var t=[];r.has(e.address,"road")&&t.push(e.address.road),r.has(e.address,"house_number")&&t.push(e.address.house_number);var n=[];r.has(e.address,"postcode")&&n.push(e.address.postcode),r.has(e.address,"city")&&n.push(e.address.city);var i=[];return t.length>0&&i.push(t.join(" ")),n.length>0&&i.push(n.join(", ")),0==t.length&&0==n.length&&i.push(e.display_name),i.join(", ")},formatPhotonReverseGeocoding:function(e){e=e.features[0].properties;var t=[];r.has(e,"name")&&t.push(e.name),r.has(e,"street")&&t.push(e.street),r.has(e,"housenumber")&&t.push(e.housenumber);var n=[];r.has(e,"postcode")&&n.push(e.postcode),r.has(e,"city")&&n.push(e.city);var i=[];return t.length>0&&i.push(t.join(" ")),n.length>0&&i.push(n.join(", ")),0==t.length&&0==n.length&&i.push("Reverse geocoding not possible."),i.join(", ")},parsePolygons:function(e){for(var t=[],n=0;n<e.length;n++)for(var i=e[n],o=0;o<i.polygons.length;o++){var a=i.polygons[o],s=r.polygon(a.travelTime,a.area,r.lineString(r.Util.parseLatLonArray(a.outerBoundary))),l=r.findWhere(r.config.defaultTravelTimeControlOptions.travelTimes,{time:s.getTravelTime()});s.setColor(r.isUndefined(l)?"#000000":l.color);var h=r.findWhere(r.config.defaultTravelTimeControlOptions.travelTimes,{time:s.getTravelTime()});if(s.setOpacity(r.isUndefined(h)?1:h.opacity),"undefined"!=typeof a.innerBoundary)for(var u=0;u<a.innerBoundary.length;u++)s.addInnerBoundary(r.lineString(r.Util.parseLatLonArray(a.innerBoundary[u])));r.PolygonUtil.addPolygonToMultiPolygon(t,s)}return t.sort(function(e,t){return t.getTravelTime()-e.getTravelTime()}),t},parseRoutes:function(e){for(var t=new Array,n=0;n<e.routes.length;n++)t.push(r.route(e.routes[n].travelTime,e.routes[n].segments));return t},webMercatorToLeaflet:function(e){return r.CRS.EPSG3857.transformation._transform(r.point(e.x/6378137,e.y/6378137))},webMercatorToLatLng:function(e,t){var n=r.CRS.EPSG3857.projection.unproject(new r.Point(e.x,e.y));return"undefined"!=typeof t?r.latLng([n.lat,n.lng,t]):n},latLngToWebMercator:function(e){var t=r.Projection.SphericalMercator.project(e);return t.x*=6378137,t.y*=6378137,t},getUserAgent:function(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(e=/\brv[ :]+(\d+)/g.exec(t)||[],"IE "+(e[1]||"")):"Chrome"===n[1]&&(e=t.match(/\bOPR\/(\d+)/),null!=e)?"Opera "+e[1]:(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),n.join(" "))},isAnimated:function(){var e=getUserAgent();return-1!=e.indexOf("IE")?!1:-1!=e.indexOf("Safari")?!1:-1!=e.indexOf("Firefox")?!1:r.config.defaultPolygonLayerOptions.animate?!0:!1},getTranslation:function(e){var t=r.Util.getUserAgent();return-1!=t.indexOf("IE 9")?"transform:translate("+e.x+"px,"+e.y+"px)":-1!=t.indexOf("Safari")?"-webkit-transform:translate3d("+e.x+"px,"+e.y+"px,0px)":-1!=t.indexOf("Firefox")?"-moz-transform:translate3d("+e.x+"px,"+e.y+"px,0px)":"transform:translate3d("+e.x+"px,"+e.y+"px,0px)"},formatNum:function(e,t){var n=Math.pow(10,t||5);return Math.round(e*n)/n},isArray:Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},extend:function(e){var t,n,i,o;for(n=1,i=arguments.length;i>n;n++){o=arguments[n];for(t in o)e[t]=o[t]}return e}},r.extend=r.Util.extend,r.DomUtil={setPosition:function(e,t){r.Browser.any3d?r.DomUtil.setTransform(e,t):(e.style.left=t.x+"px",e.style.top=t.y+"px")},setTransform:function(e,t,n){var i=t||new r.Point(0,0);e.style[r.DomUtil.TRANSFORM]="translate3d("+i.x+"px,"+i.y+"px,0)"+(n?" scale("+n+")":"")},testProp:function(e){for(var n=t.documentElement.style,i=0;i<e.length;i++)if(e[i]in n)return e[i];return!1}},function(){r.DomUtil.TRANSFORM=r.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"])}(),r.TravelOptions=function(){this.sources=[],this.targets=[],this.service,this.bikeSpeed=n,this.bikeUphill=n,this.bikeDownhill=n,this.walkSpeed=n,this.walkUphill=n,this.walkDownhill=n,this.supportWatts=n,this.renderWatts=n,this.travelTimes=n,this.travelType=n,this.elevationEnabled=n,this.minPolygonHoleSize=n,this.time=n,this.date=n,this.recommendations=n,this.errors=[],this.intersectionMode=n,this.pathSerializer=r.config.pathSerializer,this.polygonSerializer="json",this.pointReduction=!0,this.maxRoutingTime=n,this.serviceUrl=n,this.serviceKey=n,this.waitControl,this.isValidPolygonServiceOptions=function(e){return this.errors=[],"[object Array]"===Object.prototype.toString.call(this.getSources())?0==this.getSources().length?this.getErrors().push("Sources do not contain any points!"):this.getSources().forEach(function(e){r.has(e,"lat")||"function"==typeof e.getLatLng||this.getErrors().push("Sources contains source with undefined latitude!"),r.has(e,"lon")||r.has(e,"lng")||"function"==typeof e.getLatLng||this.getErrors().push("Sources contains source with undefined longitude!")}):this.getErrors().push("Sources are not of type array!"),r.contains(["bike","transit","walk","car","rentbike","rentandreturnbike","ebike"],this.getTravelType())?"car"==this.getTravelType()||("bike"==this.getTravelType()||"rentbike"==this.getTravelType()||"rentandreturnbike"==this.getTravelType()?(""!=typeof this.getBikeUphill()&&""!=typeof this.getBikeDownhill()&&"undefined"!=typeof this.getBikeUphill()&&(this.getBikeUphill()<0||this.getBikeDownhill()>0||this.getBikeUphill()<-this.getBikeDownhill())&&this.getErrors().push("Uphill cycle speed has to be larger then 0. Downhill cycle speed has to be smaller then 0.                             Absolute value of downhill cycle speed needs to be smaller then uphill cycle speed."),this.getBikeSpeed()<=0&&this.getErrors().push("Bike speed needs to be larger then 0.")):"walk"==this.getTravelType()?(""!=typeof this.getBikeUphill()&&""!=typeof this.getBikeDownhill()&&"undefined"!=typeof this.getBikeUphill()&&(this.getWalkUphill()<0||this.getWalkDownhill()>0||this.getWalkUphill()<-this.getWalkDownhill())&&this.getErrors().push("Uphill walking speed has to be larger then 0. Downhill walking speed has to be smaller then 0.                             Absolute value of downhill walking speed needs to be smaller then uphill walking speed."),this.getWalkSpeed()<=0&&this.getErrors().push("Walk speed needs to be larger then 0.")):"transit"==this.getTravelType()):this.getErrors().push("Not supported travel type given: "+this.getTravelType()),e||("undefined"==typeof this.getTravelTimes()||"[object Array]"!==Object.prototype.toString.call(this.getTravelTimes())?this.getErrors().push("Travel times have to be an array!"):r.filter(this.getTravelTimes(),function(e){return"number"!=typeof e}).length>0&&this.getErrors().push("Travel times contain non number entries: "+this.getTravelTimes())),0==this.errors.length},this.isValidRouteServiceOptions=function(){return this.isValidPolygonServiceOptions(!0),"[object Array]"===Object.prototype.toString.call(this.getTargets())?0==this.getTargets().length?this.getErrors().push("Sources do not contain any points!"):this.getTargets().forEach(function(e){r.has(e,"lat")||"function"==typeof e.getLatLng||this.getErrors().push("Targets contains target with undefined latitude!"),r.has(e,"lon")||r.has(e,"lng")||"function"==typeof e.getLatLng||this.getErrors().push("Targets contains target with undefined longitude!")}):this.getErrors().push("Targets are not of type array!"),r.contains(["travelTime","compact","detailed"],this.getPathSerializer())||this.getErrors().push("Path serializer not supported: "+this.getPathSerializer()),0==this.errors.length},this.isValidTimeServiceOptions=function(){return this.isValidRouteServiceOptions(),r.contains(["travelTime","compact","detailed"],this.getPathSerializer())||this.getErrors().push("Path serializer not supported: "+this.getPathSerializer()),0==this.errors.length},this.getErrors=function(){return this.errors},this.getSources=function(){return this.sources},this.addSource=function(e){this.sources.push(e)},this.addTarget=function(e){this.targets.push(e)},this.getTargets=function(){return this.targets},this.getBikeSpeed=function(){return this.bikeSpeed},this.getBikeUphill=function(){return this.bikeUphill},this.getBikeDownhill=function(){return this.bikeDownhill},this.getWalkSpeed=function(){return this.walkSpeed},this.getWalkUphill=function(){return this.walkUphill},this.getWalkDownhill=function(){return this.walkDownhill},this.getTravelTimes=function(){return this.travelTimes},this.getTravelType=function(){return this.travelType},this.getTime=function(){return this.time},this.getDate=function(){return this.date},this.getWaitControl=function(){return this.waitControl},this.getService=function(){return this.service},this.getPathSerializer=function(){return this.pathSerializer},this.getPolygonSerializer=function(){return this.polygonSerializer},this.getMaxRoutingTime=function(){
return this.maxRoutingTime},this.getIntersectionMode=function(){return this.intersectionMode},this.getRecommendations=function(){return this.recommendations},this.getServiceUrl=function(){return this.serviceUrl},this.getServiceKey=function(){return this.serviceKey},this.setServiceKey=function(e){this.serviceKey=e},this.setServiceUrl=function(e){this.serviceUrl=e},this.setRecommendations=function(e){this.recommendations=e},this.setIntersectionMode=function(e){this.intersectionMode=e},this.setMaxRoutingTime=function(e){this.maxRoutingTime=e},this.setPathSerializer=function(e){this.pathSerializer=e},this.setPolygonSerializer=function(e){this.polygonSerializer=e},this.setService=function(e){this.service=e},this.setMinPolygonHoleSize=function(e){this.minPolygonHoleSize=e},this.getMinPolygonHoleSize=function(){return this.minPolygonHoleSize},this.setSources=function(e){this.sources=e},this.setTargets=function(e){this.targets=e},this.setBikeSpeed=function(e){this.bikeSpeed=e},this.setBikeUphill=function(e){this.bikeUphill=e},this.setBikeDownhill=function(e){this.bikeDownhill=e},this.setWalkSpeed=function(e){this.walkSpeed=e},this.setWalkUphill=function(e){this.walkUphill=e},this.setWalkDownhill=function(e){this.walkDownhill=e},this.setTravelTimes=function(e){this.travelTimes=e},this.setTravelType=function(e){this.travelType=e},this.setTime=function(e){this.time=e},this.setDate=function(e){this.date=e},this.setWaitControl=function(e){this.waitControl=e},this.isElevationEnabled=function(){return this.elevationEnabled},this.setElevationEnabled=function(e){this.elevationEnabled=e},this.setRenderWatts=function(e){this.renderWatts=e},this.getRenderWatts=function(){return this.renderWatts},this.setSupportWatts=function(e){this.supportWatts=e},this.getSupportWatts=function(){return this.supportWatts},this.disablePointReduction=function(){this.pointReduction=!1},this.enablePointReduction=function(){this.pointReduction=!0},this.isPointReductionEnabled=function(){return this.pointReduction}},r.travelOptions=function(){return new r.TravelOptions},r.PolygonService={cache:{},getCfg:function(e){var t={};return t.sources=[],r.isUndefined(e.isElevationEnabled())||(t.elevation=e.isElevationEnabled()),r.isUndefined(e.getTravelTimes())&&r.isUndefined(e.getIntersectionMode())&&r.isUndefined(e.getRenderWatts())&&r.isUndefined(e.getSupportWatts())||(t.polygon={},r.isUndefined(e.getTravelTimes())||(t.polygon.values=e.getTravelTimes()),r.isUndefined(e.getIntersectionMode())||(t.polygon.intersectionMode=e.getIntersectionMode()),r.isUndefined(e.getPolygonSerializer())||(t.polygon.serializer=e.getPolygonSerializer()),r.isUndefined(e.isPointReductionEnabled())||(t.polygon.pointReduction=e.isPointReductionEnabled()),r.isUndefined(e.getRenderWatts())||(t.polygon.renderWatts=e.getRenderWatts()),r.isUndefined(e.getSupportWatts())||(t.polygon.supportWatts=e.getSupportWatts()),r.isUndefined(e.getMinPolygonHoleSize())||(t.polygon.minPolygonHoleSize=e.getMinPolygonHoleSize())),e.getSources().forEach(function(n){var i={lat:r.has(n,"lat")?n.lat:n.getLatLng().lat,lng:r.has(n,"lon")?n.lon:r.has(n,"lng")?n.lng:n.getLatLng().lng,id:r.has(n,"id")?n.id:"",tm:{}},o=r.has(n,"travelType")?n.travelType:e.getTravelType();i.tm[o]={},("transit"==o||"biketransit"==o)&&(i.tm[o].frame={},r.isUndefined(e.getTime())||(i.tm[o].frame.time=e.getTime()),r.isUndefined(e.getDate())||(i.tm[o].frame.date=e.getDate())),"ebike"==o&&(i.tm.ebike={},r.isUndefined(e.getBikeSpeed())||(i.tm.ebike.speed=e.getBikeSpeed()),r.isUndefined(e.getBikeUphill())||(i.tm.ebike.uphill=e.getBikeUphill()),r.isUndefined(e.getBikeDownhill())||(i.tm.ebike.downhill=e.getBikeDownhill())),"rentbike"==o&&(i.tm.rentbike={},r.isUndefined(e.getBikeSpeed())||(i.tm.rentbike.bikespeed=e.getBikeSpeed()),r.isUndefined(e.getBikeUphill())||(i.tm.rentbike.bikeuphill=e.getBikeUphill()),r.isUndefined(e.getBikeDownhill())||(i.tm.rentbike.bikedownhill=e.getBikeDownhill()),r.isUndefined(e.getWalkSpeed())||(i.tm.rentbike.walkspeed=e.getWalkSpeed()),r.isUndefined(e.getWalkUphill())||(i.tm.rentbike.walkuphill=e.getWalkUphill()),r.isUndefined(e.getWalkDownhill())||(i.tm.rentbike.walkdownhill=e.getWalkDownhill())),"rentandreturnbike"==o&&(i.tm.rentandreturnbike={},r.isUndefined(e.getBikeSpeed())||(i.tm.rentandreturnbike.bikespeed=e.getBikeSpeed()),r.isUndefined(e.getBikeUphill())||(i.tm.rentandreturnbike.bikeuphill=e.getBikeUphill()),r.isUndefined(e.getBikeDownhill())||(i.tm.rentandreturnbike.bikedownhill=e.getBikeDownhill()),r.isUndefined(e.getWalkSpeed())||(i.tm.rentandreturnbike.walkspeed=e.getWalkSpeed()),r.isUndefined(e.getWalkUphill())||(i.tm.rentandreturnbike.walkuphill=e.getWalkUphill()),r.isUndefined(e.getWalkDownhill())||(i.tm.rentandreturnbike.walkdownhill=e.getWalkDownhill())),"bike"==o&&(i.tm.bike={},r.isUndefined(e.getBikeSpeed())||(i.tm.bike.speed=e.getBikeSpeed()),r.isUndefined(e.getBikeUphill())||(i.tm.bike.uphill=e.getBikeUphill()),r.isUndefined(e.getBikeDownhill())||(i.tm.bike.downhill=e.getBikeDownhill())),"walk"==o&&(i.tm.walk={},r.isUndefined(e.getWalkSpeed())||(i.tm.walk.speed=e.getWalkSpeed()),r.isUndefined(e.getWalkUphill())||(i.tm.walk.uphill=e.getWalkUphill()),r.isUndefined(e.getWalkDownhill())||(i.tm.walk.downhill=e.getWalkDownhill())),t.sources.push(i)}),t},getTravelTimePolygons:function(e,t,n,i){e.getWaitControl()&&(e.getWaitControl().show(),e.getWaitControl().updateText(r.config.i18n.getSpan("polygonWait")));var o=r.PolygonService.getCfg(e);if(r.has(r.PolygonService.cache,JSON.stringify(o)))e.getWaitControl()&&e.getWaitControl().hide(),t(r.Util.parsePolygons(r.PolygonService.cache[JSON.stringify(o)]));else{var a=r.PolygonService.getAjaxOptions(e,o,t,n,"undefined"==typeof i?"GET":i);$.ajax(a)}},getAjaxOptions:function(e,t,n,i,o){var a={url:r.config.serviceUrl+r.config.serviceVersion+"/polygon?cfg="+encodeURIComponent(JSON.stringify(t))+"&cb=?&key="+r.config.serviceKey,timeout:r.config.requestTimeout,dataType:"json",type:o,success:function(o){e.getWaitControl()&&e.getWaitControl().hide(),r.has(o,"data")?"ok"==o.code?(r.PolygonService.cache[JSON.stringify(t)]=o.data,n(r.Util.parsePolygons(o.data))):r.isFunction(i)&&i(o.code,o.message):(r.PolygonService.cache[JSON.stringify(t)]=o,n(r.Util.parsePolygons(o)))},error:function(t){e.getWaitControl()&&e.getWaitControl().hide(),r.isFunction(i)&&(403==t.status?i("not-authorized",t.responseText):i("service-not-available","The travel time polygon service is currently not available, please try again later."))}};return"POST"==o&&(a.url=r.config.serviceUrl+r.config.serviceVersion+"/polygon_post?key="+r.config.serviceKey,a.data=JSON.stringify(t),a.contentType="application/json",a.async=!1),a}},r.PopulationService={cache:{},getPopulationStatistics:function(e,t,n,i){e.getWaitControl()&&(e.getWaitControl().show(),e.getWaitControl().updateText(r.config.i18n.getSpan("populationWait")));var o={};o.sources=[],"undefined"!=typeof e.isElevationEnabled()&&(o.elevation=e.isElevationEnabled()),("undefined"!=typeof e.getTravelTimes()||"undefined"!=typeof e.getIntersectionMode()||"undefined"!=typeof e.getRenderWatts()||"undefined"!=typeof e.getSupportWatts())&&(o.polygon={},"undefined"!=typeof e.getTravelTimes()&&(o.polygon.values=e.getTravelTimes()),"undefined"!=typeof e.getIntersectionMode()&&(o.polygon.intersectionMode=e.getIntersectionMode()),"undefined"!=typeof e.getRenderWatts()&&(o.polygon.renderWatts=e.getRenderWatts()),"undefined"!=typeof e.getSupportWatts()&&(o.polygon.supportWatts=e.getSupportWatts())),e.getSources().forEach(function(t){var n={lat:r.has(t,"lat")?t.lat:t.getLatLng().lat,lng:r.has(t,"lon")?t.lon:r.has(t,"lng")?t.lng:t.getLatLng().lng,id:r.has(t,"id")?t.id:t.lat+";"+t.lng,tm:{}},i=r.has(t,"travelType")?t.travelType:e.getTravelType();n.tm[i]={},"transit"==i&&(n.tm.transit.frame={},r.isUndefined(e.getTime())||(n.tm.transit.frame.time=e.getTime()),r.isUndefined(e.getDate())||(n.tm.transit.frame.date=e.getDate())),"ebike"==i&&(n.tm.ebike={},r.isUndefined(e.getBikeSpeed())||(n.tm.ebike.speed=e.getBikeSpeed()),r.isUndefined(e.getBikeUphill())||(n.tm.ebike.uphill=e.getBikeUphill()),r.isUndefined(e.getBikeDownhill())||(n.tm.ebike.downhill=e.getBikeDownhill())),"rentbike"==i&&(n.tm.rentbike={},r.isUndefined(e.getBikeSpeed())||(n.tm.rentbike.bikespeed=e.getBikeSpeed()),r.isUndefined(e.getBikeUphill())||(n.tm.rentbike.bikeuphill=e.getBikeUphill()),r.isUndefined(e.getBikeDownhill())||(n.tm.rentbike.bikedownhill=e.getBikeDownhill()),r.isUndefined(e.getWalkSpeed())||(n.tm.rentbike.walkspeed=e.getWalkSpeed()),r.isUndefined(e.getWalkUphill())||(n.tm.rentbike.walkuphill=e.getWalkUphill()),r.isUndefined(e.getWalkDownhill())||(n.tm.rentbike.walkdownhill=e.getWalkDownhill())),"rentandreturnbike"==i&&(n.tm.rentandreturnbike={},r.isUndefined(e.getBikeSpeed())||(n.tm.rentandreturnbike.bikespeed=e.getBikeSpeed()),r.isUndefined(e.getBikeUphill())||(n.tm.rentandreturnbike.bikeuphill=e.getBikeUphill()),r.isUndefined(e.getBikeDownhill())||(n.tm.rentandreturnbike.bikedownhill=e.getBikeDownhill()),r.isUndefined(e.getWalkSpeed())||(n.tm.rentandreturnbike.walkspeed=e.getWalkSpeed()),r.isUndefined(e.getWalkUphill())||(n.tm.rentandreturnbike.walkuphill=e.getWalkUphill()),r.isUndefined(e.getWalkDownhill())||(n.tm.rentandreturnbike.walkdownhill=e.getWalkDownhill())),"bike"==i&&(n.tm.bike={},r.isUndefined(e.getBikeSpeed())||(n.tm.bike.speed=e.getBikeSpeed()),r.isUndefined(e.getBikeUphill())||(n.tm.bike.uphill=e.getBikeUphill()),r.isUndefined(e.getBikeDownhill())||(n.tm.bike.downhill=e.getBikeDownhill())),"walk"==i&&(n.tm.walk={},r.isUndefined(e.getWalkSpeed())||(n.tm.walk.speed=e.getWalkSpeed()),r.isUndefined(e.getWalkUphill())||(n.tm.walk.uphill=e.getWalkUphill()),r.isUndefined(e.getWalkDownhill())||(n.tm.walk.downhill=e.getWalkDownhill())),o.sources.push(n)});var a=[];r.each(t,function(e){a.push("statistics="+e)}),r.has(r.PopulationService.cache,JSON.stringify(o)+a.join("&"))?(e.getWaitControl()&&e.getWaitControl().hide(),n(r.PopulationService.cache[JSON.stringify(o)+a.join("&")])):$.ajax({url:r.config.serviceUrl+r.config.serviceVersion+"/population?cfg="+encodeURIComponent(JSON.stringify(o))+"&cb=?&key="+r.config.serviceKey+"&"+a.join("&"),timeout:r.config.requestTimeout,dataType:"json",success:function(t){e.getWaitControl()&&e.getWaitControl().hide(),r.has(t,"data")?"ok"==t.code?(r.PopulationService.cache[JSON.stringify(o)+a.join("&")]=t.data,n(t.data)):r.isFunction(i)&&i(t.code,t.message):(r.PopulationService.cache[JSON.stringify(o)+a.join("&")]=t,n(t))},error:function(t){e.getWaitControl()&&e.getWaitControl().hide(),r.isFunction(i)&&i("service-not-available","The population service is currently not available, please try again later.")}})}},r.RouteService={cache:{},getCfg:function(e){var t={sources:[],targets:[],pathSerializer:e.getPathSerializer(),elevation:e.isElevationEnabled()};return e.getSources().forEach(function(n){var i={lat:r.has(n,"lat")?n.lat:n.getLatLng().lat,lng:r.has(n,"lon")?n.lon:r.has(n,"lng")?n.lng:n.getLatLng().lng,id:r.has(n,"id")?n.id:"",tm:{}},o=r.has(n,"travelType")?n.travelType:e.getTravelType();i.tm[o]={},("transit"==o||"biketransit"==o)&&(i.tm[o].frame={},r.isUndefined(e.getTime())||(i.tm[o].frame.time=e.getTime()),r.isUndefined(e.getDate())||(i.tm[o].frame.date=e.getDate()),r.isUndefined(e.getRecommendations())||(i.tm[o].recommendations=e.getRecommendations())),"ebike"==o&&(i.tm.ebike={},r.isUndefined(e.getBikeSpeed())||(i.tm.ebike.speed=e.getBikeSpeed()),r.isUndefined(e.getBikeUphill())||(i.tm.ebike.uphill=e.getBikeUphill()),r.isUndefined(e.getBikeDownhill())||(i.tm.ebike.downhill=e.getBikeDownhill())),"rentbike"==o&&(i.tm.rentbike={},r.isUndefined(e.getBikeSpeed())||(i.tm.rentbike.bikespeed=e.getBikeSpeed()),r.isUndefined(e.getBikeUphill())||(i.tm.rentbike.bikeuphill=e.getBikeUphill()),r.isUndefined(e.getBikeDownhill())||(i.tm.rentbike.bikedownhill=e.getBikeDownhill()),r.isUndefined(e.getWalkSpeed())||(i.tm.rentbike.walkspeed=e.getWalkSpeed()),r.isUndefined(e.getWalkUphill())||(i.tm.rentbike.walkuphill=e.getWalkUphill()),r.isUndefined(e.getWalkDownhill())||(i.tm.rentbike.walkdownhill=e.getWalkDownhill())),"rentandreturnbike"==o&&(i.tm.rentandreturnbike={},r.isUndefined(e.getBikeSpeed())||(i.tm.rentandreturnbike.bikespeed=e.getBikeSpeed()),r.isUndefined(e.getBikeUphill())||(i.tm.rentandreturnbike.bikeuphill=e.getBikeUphill()),r.isUndefined(e.getBikeDownhill())||(i.tm.rentandreturnbike.bikedownhill=e.getBikeDownhill()),r.isUndefined(e.getWalkSpeed())||(i.tm.rentandreturnbike.walkspeed=e.getWalkSpeed()),r.isUndefined(e.getWalkUphill())||(i.tm.rentandreturnbike.walkuphill=e.getWalkUphill()),r.isUndefined(e.getWalkDownhill())||(i.tm.rentandreturnbike.walkdownhill=e.getWalkDownhill())),"bike"==o&&(i.tm.bike={},r.isUndefined(e.getBikeSpeed())||(i.tm.bike.speed=e.getBikeSpeed()),r.isUndefined(e.getBikeUphill())||(i.tm.bike.uphill=e.getBikeUphill()),r.isUndefined(e.getBikeDownhill())||(i.tm.bike.downhill=e.getBikeDownhill())),"walk"==o&&(i.tm.walk={},r.isUndefined(e.getWalkSpeed())||(i.tm.walk.speed=e.getWalkSpeed()),r.isUndefined(e.getWalkUphill())||(i.tm.walk.uphill=e.getWalkUphill()),r.isUndefined(e.getWalkDownhill())||(i.tm.walk.downhill=e.getWalkDownhill())),t.sources.push(i)}),t.targets=[],e.getTargets().forEach(function(e){t.targets.push({lat:r.has(e,"lat")?e.lat:e.getLatLng().lat,lng:r.has(e,"lon")?e.lon:r.has(e,"lng")?e.lng:e.getLatLng().lng,id:r.has(e,"id")?e.id:""})}),t},getRoutes:function(e,t,n){e.getWaitControl()&&(e.getWaitControl().show(),e.getWaitControl().updateText(r.config.i18n.getSpan("routeWait")));var i=r.RouteService.getCfg(e);r.has(r.RouteService.cache,JSON.stringify(i))?(e.getWaitControl()&&e.getWaitControl().hide(),t(r.Util.parseRoutes(JSON.parse(JSON.stringify(r.RouteService.cache[JSON.stringify(i)]))))):$.ajax({url:r.config.serviceUrl+r.config.serviceVersion+"/route?cfg="+encodeURIComponent(JSON.stringify(i))+"&cb=?&key="+r.config.serviceKey,timeout:r.config.requestTimeout,dataType:"json",success:function(o){e.getWaitControl()&&e.getWaitControl().hide(),r.has(o,"data")?"ok"==o.code?(r.RouteService.cache[JSON.stringify(i)]=JSON.parse(JSON.stringify(o.data)),t(r.Util.parseRoutes(o.data))):r.isFunction(n)&&n(o.code,o.message):(r.RouteService.cache[JSON.stringify(i)]=JSON.parse(JSON.stringify(o)),t(r.Util.parseRoutes(o)))},error:function(t){e.getWaitControl()&&e.getWaitControl().hide(),r.isFunction(n)&&(403==t.status?n("not-authorized",t.responseText):n("service-not-available","The routing service is currently not available, please try again later."))}})}},r.TimeService={cache:{},getCfg:function(e){var t={sources:[],targets:[],pathSerializer:e.getPathSerializer(),maxRoutingTime:e.getMaxRoutingTime()};return r.isUndefined(e.isElevationEnabled())||(t.elevation=e.isElevationEnabled()),r.isUndefined(e.getTravelTimes())&&r.isUndefined(e.getIntersectionMode())&&r.isUndefined(e.getRenderWatts())&&r.isUndefined(e.getSupportWatts())||(t.polygon={},r.isUndefined(e.getTravelTimes())||(t.polygon.values=e.getTravelTimes()),r.isUndefined(e.getIntersectionMode())||(t.polygon.intersectionMode=e.getIntersectionMode()),r.isUndefined(e.getRenderWatts())||(t.polygon.renderWatts=e.getRenderWatts()),r.isUndefined(e.getSupportWatts())||(t.polygon.supportWatts=e.getSupportWatts()),r.isUndefined(e.getMinPolygonHoleSize())||(t.polygon.minPolygonHoleSize=e.getMinPolygonHoleSize())),e.getSources().forEach(function(n){var i={lat:r.has(n,"lat")?n.lat:n.getLatLng().lat,lng:r.has(n,"lon")?n.lon:r.has(n,"lng")?n.lng:n.getLatLng().lng,id:r.has(n,"id")?n.id:"",tm:{}};""==i.id&&(i.id=i.lat+";"+i.lng);var o=r.has(n,"travelType")?n.travelType:e.getTravelType();i.tm[o]={},("transit"==o||"biketransit"==o)&&(i.tm[o].frame={},r.isUndefined(e.getTime())||(i.tm[o].frame.time=e.getTime()),r.isUndefined(e.getDate())||(i.tm[o].frame.date=e.getDate())),"ebike"==o&&(i.tm.ebike={},r.isUndefined(e.getBikeSpeed())||(i.tm.ebike.speed=e.getBikeSpeed()),r.isUndefined(e.getBikeUphill())||(i.tm.ebike.uphill=e.getBikeUphill()),r.isUndefined(e.getBikeDownhill())||(i.tm.ebike.downhill=e.getBikeDownhill())),"rentbike"==o&&(i.tm.rentbike={},r.isUndefined(e.getBikeSpeed())||(i.tm.rentbike.bikespeed=e.getBikeSpeed()),r.isUndefined(e.getBikeUphill())||(i.tm.rentbike.bikeuphill=e.getBikeUphill()),r.isUndefined(e.getBikeDownhill())||(i.tm.rentbike.bikedownhill=e.getBikeDownhill()),r.isUndefined(e.getWalkSpeed())||(i.tm.rentbike.walkspeed=e.getWalkSpeed()),r.isUndefined(e.getWalkUphill())||(i.tm.rentbike.walkuphill=e.getWalkUphill()),r.isUndefined(e.getWalkDownhill())||(i.tm.rentbike.walkdownhill=e.getWalkDownhill())),"rentandreturnbike"==o&&(i.tm.rentandreturnbike={},r.isUndefined(e.getBikeSpeed())||(i.tm.rentandreturnbike.bikespeed=e.getBikeSpeed()),r.isUndefined(e.getBikeUphill())||(i.tm.rentandreturnbike.bikeuphill=e.getBikeUphill()),r.isUndefined(e.getBikeDownhill())||(i.tm.rentandreturnbike.bikedownhill=e.getBikeDownhill()),r.isUndefined(e.getWalkSpeed())||(i.tm.rentandreturnbike.walkspeed=e.getWalkSpeed()),r.isUndefined(e.getWalkUphill())||(i.tm.rentandreturnbike.walkuphill=e.getWalkUphill()),r.isUndefined(e.getWalkDownhill())||(i.tm.rentandreturnbike.walkdownhill=e.getWalkDownhill())),"bike"==o&&(i.tm.bike={},r.isUndefined(e.getBikeSpeed())||(i.tm.bike.speed=e.getBikeSpeed()),r.isUndefined(e.getBikeUphill())||(i.tm.bike.uphill=e.getBikeUphill()),r.isUndefined(e.getBikeDownhill())||(i.tm.bike.downhill=e.getBikeDownhill())),"walk"==o&&(i.tm.walk={},r.isUndefined(e.getWalkSpeed())||(i.tm.walk.speed=e.getWalkSpeed()),r.isUndefined(e.getWalkUphill())||(i.tm.walk.uphill=e.getWalkUphill()),r.isUndefined(e.getWalkDownhill())||(i.tm.walk.downhill=e.getWalkDownhill())),t.sources.push(i)}),e.getTargets().forEach(function(e){var e={lat:r.has(e,"lat")?e.lat:e.getLatLng().lat,lng:r.has(e,"lon")?e.lon:r.has(e,"lng")?e.lng:e.getLatLng().lng,id:r.has(e,"id")?e.id:""};""==e.id&&(e.id=e.lat+";"+e.lng),t.targets.push(e)}),t},getRouteTime:function(e,t,n){e.getWaitControl()&&(e.getWaitControl().show(),e.getWaitControl().updateText(r.config.i18n.getSpan("timeWait")));var i=r.TimeService.getCfg(e);r.has(r.TimeService.cache,JSON.stringify(i))?(e.getWaitControl()&&e.getWaitControl().hide(),t(r.TimeService.cache[JSON.stringify(i)])):$.ajax({url:r.config.serviceUrl+r.config.serviceVersion+"/time?key="+r.config.serviceKey,type:"POST",data:JSON.stringify(i),contentType:"application/json",timeout:r.config.requestTimeout,dataType:"json",success:function(o){e.getWaitControl()&&e.getWaitControl().hide(),r.has(o,"data")?"ok"==o.code?(r.TimeService.cache[JSON.stringify(i)]=o.data,t(o.data)):r.isFunction(n)&&n(o.code,o.message):(r.TimeService.cache[JSON.stringify(i)]=o,t(o))},error:function(t){e.getWaitControl()&&e.getWaitControl().hide(),r.isFunction(n)&&(403==t.status?n("not-authorized",t.responseText):n("service-not-available","The time service is currently not available, please try again later."))}})}},r.OsmService={cache:{},getPoisInBoundingBox:function(e,t,n,i,o){n&&(n.show(),n.updateText(r.config.i18n.getSpan("osmWait")));var a=$.param({tags:t},!0);"undefined"!=typeof e&&(a.northEast=e._northEast.lng+"|"+e._northEast.lat,a.southWest=e._southWest.lng+"|"+e._southWest.lat),r.has(r.OsmService.cache,a)?(n&&n.hide(),i(r.OsmService.cache[a])):$.ajax({url:r.config.osmServiceUrl+"pois/search?callback=?&"+a,timeout:r.config.requestTimeout,dataType:"json",success:function(e){n&&n.hide(),i(e)},error:function(e){n&&n.hide(),r.isFunction(o)&&o("service-not-available","The travel time polygon service is currently not available, please try again later.")}})}},r.Projection={},r.Projection.SphericalMercator={R:6378137,project:function(e){var t=Math.PI/180,n=1-1e-15,i=Math.max(Math.min(Math.sin(e.lat*t),n),-n);return new r.Point(this.R*e.lng*t,this.R*Math.log((1+i)/(1-i))/2)},unproject:function(e){var t=180/Math.PI;return new r.LatLng((2*Math.atan(Math.exp(e.y/this.R))-Math.PI/2)*t,e.x*t/this.R)},bounds:function(){var e=6378137*Math.PI;return r.bounds([-e,-e],[e,e])}()},r.Transformation=function(e,t,n,i){this._a=e,this._b=t,this._c=n,this._d=i},r.Transformation.prototype={transform:function(e,t){return this._transform(e.clone(),t)},_transform:function(e,t){return t=t||1,e.x=t*(this._a*e.x+this._b),e.y=t*(this._c*e.y+this._d),e},untransform:function(e,t){return t=t||1,new r.Point((e.x/t-this._b)/this._a,(e.y/t-this._d)/this._c)}},r.CRS={latLngToPoint:function(e,t){var n=this.projection.project(e),i=this.scale(t);return this.transformation._transform(n,i)},pointToLatLng:function(e,t){var n=this.scale(t),i=this.transformation.untransform(e,n);return this.projection.unproject(i)},project:function(e){return this.projection.project(e)},unproject:function(e){return this.projection.unproject(e)},scale:function(e){return 256*Math.pow(2,e)},getProjectedBounds:function(e){if(this.infinite)return null;var t=this.projection.bounds,n=this.scale(e),i=this.transformation.transform(t.min,n),o=this.transformation.transform(t.max,n);return r.bounds(i,o)},wrapLatLng:function(e){var t=this.wrapLng?r.Util.wrapNum(e.lng,this.wrapLng,!0):e.lng,n=this.wrapLat?r.Util.wrapNum(e.lat,this.wrapLat,!0):e.lat,i=e.alt;return r.latLng(n,t,i)}},r.CRS.Earth=r.extend({},r.CRS,{wrapLng:[-180,180],R:6378137,distance:function(e,t){var n=Math.PI/180,i=e.lat*n,o=t.lat*n,r=Math.sin(i)*Math.sin(o)+Math.cos(i)*Math.cos(o)*Math.cos((t.lng-e.lng)*n);return this.R*Math.acos(Math.min(r,1))}}),r.CRS.EPSG3857=r.extend({},r.CRS.Earth,{code:"EPSG:3857",projection:r.Projection.SphericalMercator,transformation:function(){var e=.5/Math.PI;return new r.Transformation(e,.5,-e,.5)}()}),r.CRS.EPSG900913=r.extend({},r.CRS.EPSG3857,{code:"EPSG:900913"}),r.polygon=function(e,t,n){return new r.Polygon(e,t,n)},r.Polygon=function(e,t,i){this.travelTime=e,this.area=t,this.color="black",this.opacity=.5,this.lineStrings=[i],this.bounds=n,this.setTravelTime=function(e){this.travelTime=e},this.getTravelTime=function(){return this.travelTime},this.getColor=function(){return this.color},this.setColor=function(e){this.color=e},this.setOpacity=function(e){this.opacity=e},this.getOpacity=function(){return this.opacity},this.getArea=function(){return this.area},this.setArea=function(e){this.area=e},this.getOuterBoundary=function(){return this.lineStrings[0]},this.getInnerBoundary=function(){return this.lineStrings.slice(1)},this.getTopRight4326=function(){return this.getOuterBoundary().getTopRight4326()},this.getTopRight3857=function(){return this.getOuterBoundary().getTopRight3857()},this.getTopRightDecimal=function(){return this.getOuterBoundary().getTopRightDecimal()},this.getBottomLeft4326=function(){return this.getOuterBoundary().getBottomLeft4326()},this.getBottomLeft3857=function(){return this.getOuterBoundary().getBottomLeft3857()},this.getBottomLeftDecimal=function(){return this.getOuterBoundary().getBottomLeftDecimal()},this.addInnerBoundary=function(e){this.lineStrings.push(e)}},r.MultiPolygon=function(){this.travelTime,this.color,this.polygons=new Array,this.topRight_3857=new r.Point(-20026377,-20048967),this.bottomLeft_3857=new r.Point(20026377,20048967),this.addPolygon=function(e){this.polygons.push(e),e.getOuterBoundary().getTopRight3857().x>this.topRight_3857.x&&(this.topRight_3857.x=e.getOuterBoundary().getTopRight3857().x),e.getOuterBoundary().getTopRight3857().y>this.topRight_3857.y&&(this.topRight_3857.y=e.getOuterBoundary().getTopRight3857().y),e.getOuterBoundary().getBottomLeft3857().x<this.bottomLeft_3857.x&&(this.bottomLeft_3857.x=e.getOuterBoundary().getBottomLeft3857().x),e.getOuterBoundary().getBottomLeft3857().y<this.bottomLeft_3857.y&&(this.bottomLeft_3857.y=e.getOuterBoundary().getBottomLeft3857().y)},this.getBoundingBox3857=function(){return r.bounds(this.bottomLeft_3857,this.topRight_3857)},this.getBoundingBox4326=function(){return r.latLngBounds(r.Util.webMercatorToLatLng(this.bottomLeft_3857),r.Util.webMercatorToLatLng(this.topRight_3857))},this.setOpacity=function(e){this.opacity=e},this.getOpacity=function(){return this.opacity},this.getArea=function(){var e=0;return this.polygons.forEach(function(t){e+=t.getArea()}),e},this.getPolygons=function(){return this.polygons},this.setColor=function(e){this.color=e},this.getColor=function(){return this.color},this.getTravelTime=function(){return this.travelTime},this.setTravelTime=function(e){this.travelTime=e}},r.multiPolygon=function(){return new r.MultiPolygon},r.lineString=function(e){return new r.LineString(e)},r.LineString=function(e){this.topRight_3857=new r.Point(-20026377,-20048967),this.bottomLeft_3857=new r.Point(20026377,20048967),this.coordinates=[];for(var t=e.length-1;t>=0;t--)e[t].x>this.topRight_3857.x&&(this.topRight_3857.x=e[t].x),e[t].y>this.topRight_3857.y&&(this.topRight_3857.y=e[t].y),e[t].x<this.bottomLeft_3857.x&&(this.bottomLeft_3857.x=e[t].x),e[t].y<this.bottomLeft_3857.y&&(this.bottomLeft_3857.y=e[t].y);for(var t=0;t<e.length;t++)this.coordinates.push(r.Util.webMercatorToLeaflet(e[t]));this.getTopRight4326=function(){return r.Util.webMercatorToLatLng(new r.Point(this.topRight_3857.x,this.topRight_3857.y))},this.getTopRight3857=function(){return this.topRight_3857},this.getTopRightDecimal=function(){return r.Util.webMercatorToLeaflet(this.topRight_3857)},this.getBottomLeft4326=function(){return r.Util.webMercatorToLatLng(new r.Point(this.bottomLeft_3857.x,this.bottomLeft_3857.y))},this.getBottomLeft3857=function(){return this.bottomLeft_3857},this.getBottomLeftDecimal=function(){return r.Util.webMercatorToLeaflet(this.bottomLeft_3857)},this.getCoordinates=function(){return this.coordinates},this.getCoordinate=function(e){return this.coordinate[e]}},r.RouteSegment=function(e){var t=this;if(t.points=[],t.type=e.type,t.travelTime=e.travelTime,t.distance=e.length/1e3,t.warning=e.warning,t.elevationGain=e.elevationGain,t.errorMessage,t.transitSegment=!1,t.startname=e.startname,t.endname=e.endname,e.points.forEach(function(e){t.points.push(r.Util.webMercatorToLatLng(new r.Point(e[1],e[0]),e[2]))}),e.isTransit){var n=r.findWhere(r.config.routeTypes,{routeType:e.routeType});t.color="undefined"!=typeof n&&r.has(n,"color")?n.color:"RED",t.haloColor="undefined"!=typeof n&&r.has(n,"haloColor")?n.haloColor:"WHITE",t.transitSegment=!0,t.routeType=e.routeType,t.routeShortName=e.routeShortName,t.startname=e.startname,t.endname=e.endname,t.departureTime=e.departureTime,t.arrivalTime=e.arrivalTime,t.tripHeadSign=e.tripHeadSign}else{var n=r.findWhere(r.config.routeTypes,{routeType:e.type});t.color="undefined"!=typeof n&&r.has(n,"color")?n.color:"RED",t.haloColor="undefined"!=typeof n&&r.has(n,"haloColor")?n.haloColor:"WHITE"}t.getPoints=function(){return t.points},t.getType=function(){return t.type},t.getHaloColor=function(){return t.haloColor},t.getColor=function(){return t.color},t.getTravelTime=function(){return t.travelTime},t.getDistance=function(){return t.distance},t.getRouteType=function(){return t.routeType},t.getRouteShortName=function(){return t.routeShortName},t.getStartName=function(){return t.startname},t.getEndName=function(){return t.endname},t.getDepartureTime=function(){return t.departureTime},t.getArrivalTime=function(){return t.arrivalTime},t.getTripHeadSign=function(){return t.tripHeadSign},t.getWarning=function(){return t.warning},t.getElevationGain=function(){return t.elevationGain},t.isTransit=function(){return t.transitSegment}},r.routeSegment=function(e){return new r.RouteSegment(e)},r.Route=function(e,t){var i=this;i.travelTime=e,i.routeSegments=[],i.points=[],i.uphillMeter=0,i.downhillMeter=0,i.targetHeight=n,i.sourceHeight=n,t.reverse().forEach(function(e){var t=r.routeSegment(e);i.routeSegments.push(t),i.points=i.points.concat(t.getPoints().reverse())}),i.equals=function(e){return i.getKey()===e.getKey()},i.getKey=function(){var t=e,n="";return i.getSegments().forEach(function(e){t+=" "+e.getRouteShortName()+" "+e.getDepartureTime()+" "+e.getArrivalTime(),e.getPoints().forEach(function(e){n+=" "+e.lat+e.lng})}),t+n},i.addRouteSegment=function(e){i.routeSegments.push(e)},i.setTravelTime=function(e){i.travelTime=e},i.getDistance=function(){for(var e=0,t=0;t<i.routeSegments.length;t++)e+=i.routeSegments[t].getDistance();return e},i.getElevationGain=function(){for(var e=0,t=0;t<i.routeSegments.length;t++)e+=i.routeSegments[t].getElevationGain();return e},i.getElevations=function(){for(var e={x:[],y:[]},t=0;t<1e3*i.getDistance();t+=100)e.x.push(t/1e3+" km"),e.y.push(i.getElevationAt(t));return e},i.getElevationAt=function(e){for(var t=0,n=1;n<i.points.length;n++){var o=i.points[n-1],r=i.points[n],a=o.distanceTo(r);if(t+=a,t>e)return r.alt}},i.getSegments=function(){return i.routeSegments},i.getUphillElevation=function(){return i.uphillMeter},i.getDownhillElevation=function(){return i.downhillMeter},i.getTotalElevationDifference=function(){return Math.abs(i.sourceHeight-i.targetHeight)},i.setElevationDifferences=function(){for(var e=n,t=i.points.length-1;t>=0;t--)0==t&&(i.targetHeight=i.points[t].alt),t==i.points.length-1&&(i.sourceHeight=i.points[t].alt),"undefined"!=typeof e&&(e>i.points[t].alt?i.uphillMeter+=e-i.points[t].alt:e<i.points[t].alt&&(i.downhillMeter+=i.points[t].alt-e)),e=i.points[t].alt}(),i.getTravelTime=function(){return i.travelTime}},r.route=function(e,t){return new r.Route(e,t)}}(window,document);